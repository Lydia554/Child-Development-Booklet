(function(){"use strict";var e={2887:function(e,t,o){var a=o(3751),i=o(641);const r={key:0};function s(e,t,o,a,s,n){const l=(0,i.g2)("router-link"),d=(0,i.g2)("router-view");return(0,i.uX)(),(0,i.CE)("div",null,[a.showNavigation?((0,i.uX)(),(0,i.CE)("nav",r,[a.authStore.isAuthenticated?((0,i.uX)(),(0,i.Wv)(l,{key:0,to:"/dashboard"},{default:(0,i.k6)((()=>t[1]||(t[1]=[(0,i.eW)("Dashboard")]))),_:1})):(0,i.Q3)("",!0),a.authStore.isAuthenticated&&!a.hasChild?((0,i.uX)(),(0,i.Wv)(l,{key:1,to:"/child-registration"},{default:(0,i.k6)((()=>t[2]||(t[2]=[(0,i.eW)("Registracija deteta")]))),_:1})):(0,i.Q3)("",!0),a.authStore.isAuthenticated&&a.hasChild&&!a.isDashboard?((0,i.uX)(),(0,i.CE)(i.FK,{key:2},[(0,i.bF)(l,{to:`/milestone-form/${a.childId}`},{default:(0,i.k6)((()=>t[3]||(t[3]=[(0,i.eW)("Dodaj Ključni Momenat")]))),_:1},8,["to"]),(0,i.bF)(l,{to:`/milestone-list/${a.childId}`},{default:(0,i.k6)((()=>t[4]||(t[4]=[(0,i.eW)("Pregled Ključnog Momenta")]))),_:1},8,["to"]),(0,i.bF)(l,{to:`/child-development-form/${a.childId}`},{default:(0,i.k6)((()=>t[5]||(t[5]=[(0,i.eW)("Unos razvoja deteta")]))),_:1},8,["to"]),(0,i.bF)(l,{to:`/child-development-list/${a.childId}`},{default:(0,i.k6)((()=>t[6]||(t[6]=[(0,i.eW)("Pregled razvoja")]))),_:1},8,["to"]),(0,i.bF)(l,{to:`/child-overview/${a.childId}`},{default:(0,i.k6)((()=>t[7]||(t[7]=[(0,i.eW)("Pregled sve Dece")]))),_:1},8,["to"])],64)):(0,i.Q3)("",!0),a.authStore.isAuthenticated?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.Wv)(l,{key:3,to:"/login"},{default:(0,i.k6)((()=>t[8]||(t[8]=[(0,i.eW)("Prijavite se")]))),_:1})),a.authStore.isAuthenticated?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.Wv)(l,{key:4,to:"/"},{default:(0,i.k6)((()=>t[9]||(t[9]=[(0,i.eW)("Registrujte se")]))),_:1})),a.authStore.isAuthenticated?((0,i.uX)(),(0,i.CE)("button",{key:5,onClick:t[0]||(t[0]=(...e)=>a.logout&&a.logout(...e)),class:"logout-btn"},"Odjavi se")):(0,i.Q3)("",!0)])):(0,i.Q3)("",!0),(0,i.bF)(d)])}o(4114);var n=o(810);const l=(0,n.nY)("auth",{state:()=>({isAuthenticated:!1,token:null,childIds:[],currentChildId:null}),getters:{hasChild:e=>e.childIds.length>0,childId:e=>e.currentChildId},actions:{login(e,t=null){e?(console.log("🔑 Storing token in authStore:",e),this.isAuthenticated=!0,this.token=e,sessionStorage.setItem("token",e),t&&this.addChildId(t)):console.error("❌ Trying to store an undefined token!")},logout(){console.log("🚪 Logging out, clearing token..."),this.isAuthenticated=!1,this.token=null,this.childIds=[],this.currentChildId=null,sessionStorage.removeItem("token"),sessionStorage.removeItem("childId"),sessionStorage.removeItem("childIds")},checkAuth(){const e=sessionStorage.getItem("token"),t=sessionStorage.getItem("childId"),o=JSON.parse(sessionStorage.getItem("childIds")||"[]");e?(console.log("✅ Token found in sessionStorage:",e),this.isAuthenticated=!0,this.token=e,this.childIds=o,this.currentChildId=t||null):console.warn("⚠️ No token found in sessionStorage.")},addChildId(e){this.childIds.includes(e)||(this.childIds.push(e),sessionStorage.setItem("childIds",JSON.stringify(this.childIds))),this.setCurrentChildId(e)},setCurrentChildId(e){this.currentChildId=e,sessionStorage.setItem("childId",e)}}});var d=o(5220),c={setup(){const e=l(),t=(0,d.rd)(),o=(0,d.lq)(),a=(0,i.EW)((()=>e.childId||sessionStorage.getItem("childId"))),r=(0,i.EW)((()=>!!a.value)),s=(0,i.EW)((()=>"dashboard"===o.name)),n=(0,i.EW)((()=>"login"!==o.name&&"signup"!==o.name&&("dashboard"===o.name||e.isAuthenticated&&r.value))),c=()=>{e.logout(),sessionStorage.removeItem("token"),sessionStorage.removeItem("childId"),t.push("/login")};return e.checkAuth(),{authStore:e,logout:c,childId:a,hasChild:r,isDashboard:s,showNavigation:n}}},h=o(6262);const u=(0,h.A)(c,[["render",s],["__scopeId","data-v-7d9f8912"]]);var m=u,p=o(33);const v={class:"dashboard-container"},g={key:0},k={key:1,class:"error-message"},f={key:2},b={class:"dashboard-links"},D={class:"links-grid"},y={class:"register-another-child"},I={key:3,class:"error-message"};function C(e,t,o,a,r,s){const n=(0,i.g2)("router-link");return(0,i.uX)(),(0,i.CE)("div",v,[t[8]||(t[8]=(0,i.Lk)("h2",null,"Dobrodošli na Dashboard",-1)),a.loading?((0,i.uX)(),(0,i.CE)("div",g,"Loading...")):a.errorMessage?((0,i.uX)(),(0,i.CE)("div",k,(0,p.v_)(a.errorMessage),1)):a.currentChild&&a.currentChild._id?((0,i.uX)(),(0,i.CE)("div",f,[(0,i.Lk)("h3",null,"Opcije za dete: "+(0,p.v_)(a.currentChild.name),1),(0,i.Lk)("div",b,[(0,i.Lk)("div",D,[(0,i.bF)(n,{to:`/milestone-form/${a.currentChild._id}`,class:"dashboard-link"},{default:(0,i.k6)((()=>t[0]||(t[0]=[(0,i.eW)("Dodaj Ključni Momenat")]))),_:1},8,["to"]),(0,i.bF)(n,{to:`/milestone-list/${a.currentChild._id}`,class:"dashboard-link"},{default:(0,i.k6)((()=>t[1]||(t[1]=[(0,i.eW)("Pregled Ključnog Momenta")]))),_:1},8,["to"]),(0,i.bF)(n,{to:`/child-development-form/${a.currentChild._id}`,class:"dashboard-link"},{default:(0,i.k6)((()=>t[2]||(t[2]=[(0,i.eW)("Unos razvoja deteta")]))),_:1},8,["to"]),(0,i.bF)(n,{to:`/child-development-list/${a.currentChild._id}`,class:"dashboard-link"},{default:(0,i.k6)((()=>t[3]||(t[3]=[(0,i.eW)("Pregled razvoja")]))),_:1},8,["to"]),(0,i.bF)(n,{to:`/child-overview/${a.currentChild._id}`,class:"dashboard-link"},{default:(0,i.k6)((()=>t[4]||(t[4]=[(0,i.eW)("Pregled sve Dece")]))),_:1},8,["to"])])]),(0,i.Lk)("div",y,[(0,i.bF)(n,{to:"/child-registration",class:"dashboard-link"},{default:(0,i.k6)((()=>t[5]||(t[5]=[(0,i.eW)("Registruj Još Jedno Dete")]))),_:1})])])):((0,i.uX)(),(0,i.CE)("div",I,[t[7]||(t[7]=(0,i.Lk)("p",null,"Nema podataka o detetu. Molimo proverite unos ili registrujte dete.",-1)),(0,i.bF)(n,{to:"/child-registration",class:"dashboard-link"},{default:(0,i.k6)((()=>t[6]||(t[6]=[(0,i.eW)("Registruj Dete")]))),_:1})]))])}var E=o(4335),L=o(953),A={setup(){const e=l(),t=(0,L.KR)(!0),o=(0,L.KR)(null),a=(0,L.KR)(""),r=async()=>{try{let t=e.childId;if(!t)return void(a.value="Nema registrovanog deteta. Molimo registrujte dete.");const i=await E.A.get(`http://localhost:5000/api/${t}`,{headers:{Authorization:`Bearer ${sessionStorage.getItem("token")}`}});o.value=i.data}catch(i){console.error("❌ Greška prilikom učitavanja deteta:",i),a.value="Greška prilikom učitavanja podataka."}finally{t.value=!1}};return(0,i.sV)((()=>{r()})),(0,i.wB)((()=>e.childId),(async e=>{e&&(console.log("🔄 Detected child change, refreshing data..."),await r())})),{loading:t,currentChild:o,errorMessage:a}}};const j=(0,h.A)(A,[["render",C],["__scopeId","data-v-319c3f15"]]);var P=j;const _={class:"signup-container"},w={key:0,class:"error-message"},$={class:"password-container"},M=["type"],z={key:0,class:"error-message"},F={key:1,class:"error-message"},S=["disabled"],X={class:"login-link"};function N(e,t,o,r,s,n){return(0,i.uX)(),(0,i.CE)("div",_,[t[14]||(t[14]=(0,i.Lk)("h2",null,"Registrujte se",-1)),(0,i.Lk)("form",{onSubmit:t[10]||(t[10]=(0,a.D$)(((...e)=>n.registerUser&&n.registerUser(...e)),["prevent"]))},[(0,i.bo)((0,i.Lk)("input",{type:"email","onUpdate:modelValue":t[0]||(t[0]=e=>s.email=e),placeholder:"Email",required:"",onBlur:t[1]||(t[1]=(...e)=>n.validateEmail&&n.validateEmail(...e)),onInput:t[2]||(t[2]=(...e)=>n.validateForm&&n.validateForm(...e))},null,544),[[a.Jo,s.email]]),s.emailError?((0,i.uX)(),(0,i.CE)("div",w,(0,p.v_)(s.emailError),1)):(0,i.Q3)("",!0),(0,i.Lk)("div",$,[(0,i.bo)((0,i.Lk)("input",{type:s.passwordVisible?"text":"password","onUpdate:modelValue":t[3]||(t[3]=e=>s.password=e),placeholder:"Lozinka",required:"",onBlur:t[4]||(t[4]=(...e)=>n.validatePassword&&n.validatePassword(...e)),onInput:t[5]||(t[5]=(...e)=>n.validateForm&&n.validateForm(...e))},null,40,M),[[a.hp,s.password]]),(0,i.Lk)("label",null,[(0,i.bo)((0,i.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[6]||(t[6]=e=>s.passwordVisible=e)},null,512),[[a.lH,s.passwordVisible]]),t[12]||(t[12]=(0,i.eW)(" Prikaži lozinku "))]),s.passwordError?((0,i.uX)(),(0,i.CE)("div",z,(0,p.v_)(s.passwordError),1)):(0,i.Q3)("",!0)]),(0,i.bo)((0,i.Lk)("input",{type:"text","onUpdate:modelValue":t[7]||(t[7]=e=>s.name=e),placeholder:"Ime",required:"",onBlur:t[8]||(t[8]=(...e)=>n.validateName&&n.validateName(...e)),onInput:t[9]||(t[9]=(...e)=>n.validateForm&&n.validateForm(...e))},null,544),[[a.Jo,s.name]]),s.nameError?((0,i.uX)(),(0,i.CE)("div",F,(0,p.v_)(s.nameError),1)):(0,i.Q3)("",!0),(0,i.Lk)("button",{type:"submit",disabled:s.hasErrors},"Registrujte se",8,S)],32),(0,i.Lk)("div",X,[(0,i.Lk)("p",null,[t[13]||(t[13]=(0,i.eW)("Već imate nalog? ")),(0,i.Lk)("button",{onClick:t[11]||(t[11]=(...e)=>n.navigateToLogin&&n.navigateToLogin(...e))},"Ulogujte se")])])])}var T={data(){return{name:"",email:"",password:"",passwordVisible:!1,errorMessage:"",emailError:null,passwordError:null,nameError:null,hasErrors:!0}},methods:{validateEmail(){const e=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;this.email.trim()?e.test(this.email)?this.emailError=null:(this.emailError="Unesite validan email.",this.hasErrors=!0):(this.emailError="Email je obavezan.",this.hasErrors=!0)},validatePassword(){this.password.trim()?this.password.length<6?(this.passwordError="Lozinka mora imati najmanje 6 karaktera.",this.hasErrors=!0):this.passwordError=null:(this.passwordError="Lozinka je obavezna.",this.hasErrors=!0)},validateName(){this.name.trim()?this.nameError=null:(this.nameError="Ime je obavezno.",this.hasErrors=!0)},validateForm(){this.validateEmail(),this.validatePassword(),this.validateName(),this.hasErrors=!!(this.emailError||this.passwordError||this.nameError)},async registerUser(){if(this.validateForm(),!this.hasErrors)try{const e=await E.A.post("http://localhost:5000/api/users/register",{name:this.name,email:this.email,password:this.password},{headers:{"Content-Type":"application/json"}});console.log("Registration successful:",e.data);const t=await E.A.post("http://localhost:5000/api/users/login",{email:this.email,password:this.password}),o=t.data.token;sessionStorage.setItem("token",o);const a=l();a.login(o),this.$router.push("/child-registration")}catch(e){console.error("Greška pri registraciji:",e),e.response?(console.log("Error response data:",e.response.data),this.errorMessage=e.response.data.message||"Server error occurred"):e.request?this.errorMessage="No response from server":this.errorMessage=e.message}},navigateToLogin(){this.$router.push("/login")}}};const W=(0,h.A)(T,[["render",N],["__scopeId","data-v-0808eace"]]);var q=W;const O={class:"login-container"},B={key:0,class:"error-message"},U={class:"password-container"},Q=["type"],R={class:"signup-link"};function V(e,t,o,r,s,n){return(0,i.uX)(),(0,i.CE)("div",O,[t[8]||(t[8]=(0,i.Lk)("h2",null,"Prijavite se",-1)),s.errorMessage?((0,i.uX)(),(0,i.CE)("div",B,(0,p.v_)(s.errorMessage),1)):(0,i.Q3)("",!0),(0,i.Lk)("form",{onSubmit:t[3]||(t[3]=(0,a.D$)(((...e)=>n.loginUser&&n.loginUser(...e)),["prevent"]))},[(0,i.bo)((0,i.Lk)("input",{type:"email","onUpdate:modelValue":t[0]||(t[0]=e=>s.email=e),placeholder:"Email",required:""},null,512),[[a.Jo,s.email]]),(0,i.Lk)("div",U,[(0,i.bo)((0,i.Lk)("input",{type:s.passwordVisible?"text":"password","onUpdate:modelValue":t[1]||(t[1]=e=>s.password=e),placeholder:"Lozinka",required:""},null,8,Q),[[a.hp,s.password]]),(0,i.Lk)("label",null,[(0,i.bo)((0,i.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[2]||(t[2]=e=>s.passwordVisible=e)},null,512),[[a.lH,s.passwordVisible]]),t[5]||(t[5]=(0,i.eW)(" Prikaži lozinku "))])]),t[6]||(t[6]=(0,i.Lk)("button",{type:"submit"},"Prijavite se",-1))],32),(0,i.Lk)("div",R,[(0,i.Lk)("p",null,[t[7]||(t[7]=(0,i.eW)("Nemate nalog? ")),(0,i.Lk)("button",{onClick:t[4]||(t[4]=(...e)=>n.navigateToSignup&&n.navigateToSignup(...e))},"Registrujte se")])])])}o(8111),o(1701);var K={data(){return{email:"",password:"",passwordVisible:!1,errorMessage:""}},methods:{async loginUser(){try{const e=l(),t=await E.A.post("http://localhost:5000/api/users/login",{email:this.email,password:this.password}),o=t.data.token;sessionStorage.setItem("token",o),e.login(o);const a=await E.A.get("http://localhost:5000/api",{headers:{Authorization:`Bearer ${o}`}});if(a.data&&a.data.length>0){const t=a.data[0];console.log("✅ Logged-in user has child:",t),t&&t._id?(e.childIds=a.data.map((e=>e._id)),e.setCurrentChildId(t._id),sessionStorage.setItem("childIds",JSON.stringify(e.childIds)),this.$router.push("/dashboard")):(console.warn("⚠️ No valid child found. Redirecting to registration."),e.childIds=[],e.currentChildId=null,sessionStorage.removeItem("childIds"),sessionStorage.removeItem("childId"),this.$router.push("/child-registration"))}else console.warn("⚠️ No children found. Redirecting to registration."),e.childIds=[],e.currentChildId=null,sessionStorage.removeItem("childIds"),sessionStorage.removeItem("childId"),this.$router.push("/child-registration")}catch(e){console.error("❌ Login error:",e),this.errorMessage=e.response?.data?.message||"Pogrešan email ili lozinka."}},navigateToSignup(){this.$router.push("/")}}};const x=(0,h.A)(K,[["render",V],["__scopeId","data-v-3e12f589"]]);var J=x;const G={class:"development-container"},Y={class:"development-title"},H={key:0,class:"development-data"},Z={key:1},ee={class:"navigation-buttons"};function te(e,t,o,a,r,s){const n=(0,i.g2)("router-link");return(0,i.uX)(),(0,i.CE)("div",G,[(0,i.Lk)("h2",Y,"Razvoj Deteta - Period: "+(0,p.v_)(o.startAge)+"-"+(0,p.v_)(r.endAge)+" Meseci",1),r.developmentData.length?((0,i.uX)(),(0,i.CE)("div",H,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(r.developmentData,(e=>((0,i.uX)(),(0,i.CE)("div",{key:e._id,class:"development-item"},[(0,i.Lk)("p",null,[t[0]||(t[0]=(0,i.Lk)("strong",null,"Fizički razvoj:",-1)),(0,i.eW)(" "+(0,p.v_)(e.physicalDevelopment),1)]),(0,i.Lk)("p",null,[t[1]||(t[1]=(0,i.Lk)("strong",null,"Emocionalni razvoj:",-1)),(0,i.eW)(" "+(0,p.v_)(e.emotionalDevelopment),1)]),(0,i.Lk)("p",null,[t[2]||(t[2]=(0,i.Lk)("strong",null,"Intelektualni razvoj:",-1)),(0,i.eW)(" "+(0,p.v_)(e.intellectualDevelopment),1)]),(0,i.Lk)("p",null,[t[3]||(t[3]=(0,i.Lk)("strong",null,"Socijalni razvoj:",-1)),(0,i.eW)(" "+(0,p.v_)(e.socialDevelopment),1)])])))),128))])):((0,i.uX)(),(0,i.CE)("div",Z,t[4]||(t[4]=[(0,i.Lk)("p",{class:"no-data-message"},"Nema podataka za ovaj period.",-1)]))),(0,i.Lk)("div",ee,[o.startAge>0?((0,i.uX)(),(0,i.Wv)(n,{key:0,to:s.previousPeriod,class:"nav-button"},{default:(0,i.k6)((()=>t[5]||(t[5]=[(0,i.eW)("Prethodni period")]))),_:1},8,["to"])):(0,i.Q3)("",!0),(0,i.bF)(n,{to:s.nextPeriod,class:"nav-button"},{default:(0,i.k6)((()=>t[6]||(t[6]=[(0,i.eW)("Sledeći period")]))),_:1},8,["to"])])])}var oe={props:["childId","startAge"],data(){return{developmentData:[],endAge:parseInt(this.startAge)+6}},computed:{nextPeriod(){return`/child-development/${this.childId}/${this.endAge}`},previousPeriod(){return`/child-development/${this.childId}/${this.startAge-6}`}},created(){this.fetchDevelopmentData()},methods:{async fetchDevelopmentData(){try{const e=await E.A.get(`http://localhost:5000/api/child-development/${this.childId}/${this.startAge}`);this.developmentData=e.data}catch(e){console.error("Greška pri dobijanju podataka:",e)}}}};const ae=(0,h.A)(oe,[["render",te],["__scopeId","data-v-4df4a8d0"]]);var ie=ae;const re={class:"milestone-form-container"},se={class:"form-group"},ne={key:0,class:"error-message"},le={class:"form-group"},de={key:0,class:"error-message"},ce={class:"form-group"},he={key:0,class:"error-message"},ue={class:"form-group"},me={class:"button-group"},pe=["disabled"];function ve(e,t,o,r,s,n){return(0,i.uX)(),(0,i.CE)("div",re,[(0,i.Lk)("h2",null,(0,p.v_)(s.isEditing?"Izmeni Kljucni Momenat":"Dodaj Kljucni Momenat"),1),(0,i.Lk)("form",{onSubmit:t[8]||(t[8]=(0,a.D$)(((...e)=>n.submitForm&&n.submitForm(...e)),["prevent"])),class:"milestone-form"},[(0,i.Lk)("div",se,[t[9]||(t[9]=(0,i.Lk)("label",{for:"milestoneType"},"Tip Ključnog Momenta:",-1)),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>s.milestone.milestoneType=e),type:"text",id:"milestoneType",required:"",placeholder:"Npr. Prvi korak, Prva reč...",onBlur:t[1]||(t[1]=(...e)=>n.validateMilestoneType&&n.validateMilestoneType(...e))},null,544),[[a.Jo,s.milestone.milestoneType]]),s.milestoneTypeError?((0,i.uX)(),(0,i.CE)("div",ne,(0,p.v_)(s.milestoneTypeError),1)):(0,i.Q3)("",!0)]),(0,i.Lk)("div",le,[t[10]||(t[10]=(0,i.Lk)("label",{for:"milestoneDate"},"Datum:",-1)),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>s.milestone.milestoneDate=e),type:"date",id:"milestoneDate",required:"",onBlur:t[3]||(t[3]=(...e)=>n.validateMilestoneDate&&n.validateMilestoneDate(...e))},null,544),[[a.Jo,s.milestone.milestoneDate]]),s.milestoneDateError?((0,i.uX)(),(0,i.CE)("div",de,(0,p.v_)(s.milestoneDateError),1)):(0,i.Q3)("",!0)]),(0,i.Lk)("div",ce,[t[11]||(t[11]=(0,i.Lk)("label",{for:"progress"},"Napredak:",-1)),(0,i.bo)((0,i.Lk)("textarea",{"onUpdate:modelValue":t[4]||(t[4]=e=>s.milestone.progress=e),id:"progress",required:"",placeholder:"Opišite napredak...",onBlur:t[5]||(t[5]=(...e)=>n.validateProgress&&n.validateProgress(...e))},null,544),[[a.Jo,s.milestone.progress]]),s.progressError?((0,i.uX)(),(0,i.CE)("div",he,(0,p.v_)(s.progressError),1)):(0,i.Q3)("",!0)]),(0,i.Lk)("div",ue,[t[12]||(t[12]=(0,i.Lk)("label",{for:"notes"},"Napomene:",-1)),(0,i.bo)((0,i.Lk)("textarea",{"onUpdate:modelValue":t[6]||(t[6]=e=>s.milestone.notes=e),id:"notes",placeholder:"Dodatne napomene..."},null,512),[[a.Jo,s.milestone.notes]])]),(0,i.Lk)("div",me,[(0,i.Lk)("button",{type:"submit",class:"submit-btn",disabled:s.hasErrors},(0,p.v_)(s.isEditing?"Sačuvaj Izmene":"Dodaj Kljucni Momenat"),9,pe),(0,i.Lk)("button",{type:"button",onClick:t[7]||(t[7]=(...e)=>n.goBack&&n.goBack(...e)),class:"cancel-btn"},"Otkaži")])],32)])}var ge={props:["childId","milestoneId"],data(){return{milestone:{milestoneType:"",milestoneDate:"",progress:"",notes:"",startAge:this.$route.query.startAge||0,endAge:this.$route.query.endAge||0,childId:this.childId},isEditing:!1,milestoneTypeError:null,milestoneDateError:null,progressError:null,hasErrors:!1}},async created(){if(this.milestoneId){this.isEditing=!0;try{const e=sessionStorage.getItem("token"),t=await E.A.get(`http://localhost:5000/api/milestones/${this.milestoneId}`,{headers:{Authorization:`Bearer ${e}`}});t.data&&(this.milestone={...t.data,milestoneDate:new Date(t.data.milestoneDate).toISOString().split("T")[0]})}catch(e){console.error("Error fetching milestone:",e)}}},methods:{validateMilestoneType(){this.milestone.milestoneType.trim()?this.milestoneTypeError=null:(this.milestoneTypeError="Tip momenta je obavezan.",this.hasErrors=!0)},validateMilestoneDate(){this.milestone.milestoneDate?this.milestoneDateError=null:(this.milestoneDateError="Datum je obavezan.",this.hasErrors=!0)},validateProgress(){this.milestone.progress.trim()?this.progressError=null:(this.progressError="Napredak je obavezan.",this.hasErrors=!0)},async submitForm(){if(this.validateMilestoneType(),this.validateMilestoneDate(),this.validateProgress(),!this.hasErrors)try{const e=sessionStorage.getItem("token"),t={Authorization:`Bearer ${e}`};this.isEditing?await E.A.put(`http://localhost:5000/api/milestones/${this.milestoneId}`,this.milestone,{headers:t}):await E.A.post(`http://localhost:5000/api/milestones/${this.childId}`,this.milestone,{headers:t}),this.$router.push(`/child-development-list/${this.childId}`)}catch(e){console.error("Error saving milestone:",e)}},formatPeriod(e,t){return`${e}-${t} meseci`},goBack(){this.$router.push(`/child-development-list/${this.childId}`)}}};const ke=(0,h.A)(ge,[["render",ve],["__scopeId","data-v-0cd467dc"]]);var fe=ke;const be={class:"milestone-list-container"},De={key:0,class:"milestone-list"},ye={class:"button-group"},Ie=["onClick"],Ce=["onClick"],Ee={key:1,class:"no-data-message"};function Le(e,t,o,a,r,s){const n=(0,i.g2)("router-link");return(0,i.uX)(),(0,i.CE)("div",be,[t[4]||(t[4]=(0,i.Lk)("h2",null,"Pregled Kljucnih Momenata",-1)),r.milestones.length?((0,i.uX)(),(0,i.CE)("div",De,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(r.milestones,(e=>((0,i.uX)(),(0,i.CE)("div",{key:e._id,class:"milestone-item"},[(0,i.Lk)("h3",null,(0,p.v_)(e.milestoneType)+" - "+(0,p.v_)(s.formatDate(e.milestoneDate)),1),(0,i.Lk)("p",null,[t[0]||(t[0]=(0,i.Lk)("strong",null,"Napredak:",-1)),(0,i.eW)(" "+(0,p.v_)(e.progress),1)]),(0,i.Lk)("p",null,[t[1]||(t[1]=(0,i.Lk)("strong",null,"Napomene:",-1)),(0,i.eW)(" "+(0,p.v_)(e.notes),1)]),(0,i.Lk)("div",ye,[(0,i.Lk)("button",{onClick:t=>s.editMilestone(e._id),class:"edit-btn"},"Izmeni",8,Ie),(0,i.Lk)("button",{onClick:t=>s.confirmDelete(e._id),class:"delete-btn"},"Obriši",8,Ce)])])))),128))])):((0,i.uX)(),(0,i.CE)("div",Ee,t[2]||(t[2]=[(0,i.Lk)("p",null,"Nema podataka o Kljucnim Momentima za ovo dete.",-1)]))),(0,i.bF)(n,{to:`/milestone-form/${r.childId}`,class:"add-milestone-button"},{default:(0,i.k6)((()=>t[3]||(t[3]=[(0,i.eW)(" Dodaj Kljucni Momenat ")]))),_:1},8,["to"])])}o(2489);var Ae={data(){return{milestones:[],childId:null}},created(){this.childId=this.$route.params.childId,this.childId?this.fetchMilestones():this.$router.push("/child-registration")},methods:{async fetchMilestones(){try{const e=sessionStorage.getItem("token"),t=await E.A.get(`http://localhost:5000/api/milestones/${this.childId}`,{headers:{Authorization:`Bearer ${e}`}});this.milestones=t.data}catch(e){console.error("Error fetching milestones:",e)}},formatDate(e){if(!e)return"";const t=new Date(e);return`${t.getDate()}/${t.getMonth()+1}/${t.getFullYear()}`},editMilestone(e){this.$router.push(`/milestone-form/${this.childId}/${e}`)},async deleteMilestone(e){try{const t=sessionStorage.getItem("token"),o=await E.A.delete(`http://localhost:5000/api/milestones/${e}`,{headers:{Authorization:`Bearer ${t}`}});this.milestones=this.milestones.filter((t=>t._id!==e)),console.log("Milestone deleted:",o.data)}catch(t){console.error("Error deleting milestone:",t)}},async confirmDelete(e){window.confirm("Da li ste sigurni da želite da obrišete ovaj milestone?")&&await this.deleteMilestone(e)}}};const je=(0,h.A)(Ae,[["render",Le],["__scopeId","data-v-75669412"]]);var Pe=je;const _e={class:"development-form"},we={key:0,class:"error-message"},$e={class:"form-group"},Me={key:0,class:"error-message"},ze={class:"form-group"},Fe={key:0,class:"error-message"},Se={class:"form-group"},Xe={key:0,class:"error-message"},Ne={class:"form-group"},Te={key:0,class:"error-message"},We=["disabled"];function qe(e,t,o,r,s,n){return(0,i.uX)(),(0,i.CE)("div",_e,[t[13]||(t[13]=(0,i.Lk)("h2",null,"Unos Razvoja Deteta",-1)),(0,i.Lk)("h3",null,"Trenutni period: "+(0,p.v_)(s.currentPeriod.startAge)+" - "+(0,p.v_)(s.currentPeriod.endAge)+" meseci",1),(0,i.Lk)("h3",null,"Trenutna starost deteta: "+(0,p.v_)(s.childAgeInMonths)+" meseci",1),s.error?((0,i.uX)(),(0,i.CE)("div",we,(0,p.v_)(s.error),1)):(0,i.Q3)("",!0),(0,i.Lk)("form",{onSubmit:t[8]||(t[8]=(0,a.D$)(((...e)=>n.saveDevelopment&&n.saveDevelopment(...e)),["prevent"]))},[(0,i.Lk)("div",$e,[t[9]||(t[9]=(0,i.Lk)("label",{for:"physicalDevelopment"},"Fizički razvoj:",-1)),(0,i.bo)((0,i.Lk)("textarea",{id:"physicalDevelopment","onUpdate:modelValue":t[0]||(t[0]=e=>s.formData.physicalDevelopment=e),required:"",onInput:t[1]||(t[1]=e=>n.validateInput("physicalDevelopment"))},null,544),[[a.Jo,s.formData.physicalDevelopment]]),s.physicalError?((0,i.uX)(),(0,i.CE)("div",Me,(0,p.v_)(s.physicalError),1)):(0,i.Q3)("",!0)]),(0,i.Lk)("div",ze,[t[10]||(t[10]=(0,i.Lk)("label",{for:"emotionalDevelopment"},"Emocionalni razvoj:",-1)),(0,i.bo)((0,i.Lk)("textarea",{id:"emotionalDevelopment","onUpdate:modelValue":t[2]||(t[2]=e=>s.formData.emotionalDevelopment=e),required:"",onInput:t[3]||(t[3]=e=>n.validateInput("emotionalDevelopment"))},null,544),[[a.Jo,s.formData.emotionalDevelopment]]),s.emotionalError?((0,i.uX)(),(0,i.CE)("div",Fe,(0,p.v_)(s.emotionalError),1)):(0,i.Q3)("",!0)]),(0,i.Lk)("div",Se,[t[11]||(t[11]=(0,i.Lk)("label",{for:"intellectualDevelopment"},"Intelektualni razvoj:",-1)),(0,i.bo)((0,i.Lk)("textarea",{id:"intellectualDevelopment","onUpdate:modelValue":t[4]||(t[4]=e=>s.formData.intellectualDevelopment=e),required:"",onInput:t[5]||(t[5]=e=>n.validateInput("intellectualDevelopment"))},null,544),[[a.Jo,s.formData.intellectualDevelopment]]),s.intellectualError?((0,i.uX)(),(0,i.CE)("div",Xe,(0,p.v_)(s.intellectualError),1)):(0,i.Q3)("",!0)]),(0,i.Lk)("div",Ne,[t[12]||(t[12]=(0,i.Lk)("label",{for:"socialDevelopment"},"Socijalni razvoj:",-1)),(0,i.bo)((0,i.Lk)("textarea",{id:"socialDevelopment","onUpdate:modelValue":t[6]||(t[6]=e=>s.formData.socialDevelopment=e),required:"",onInput:t[7]||(t[7]=e=>n.validateInput("socialDevelopment"))},null,544),[[a.Jo,s.formData.socialDevelopment]]),s.socialError?((0,i.uX)(),(0,i.CE)("div",Te,(0,p.v_)(s.socialError),1)):(0,i.Q3)("",!0)]),(0,i.Lk)("button",{type:"submit",disabled:s.loading||s.hasErrors},(0,p.v_)(s.loading?"Čuvanje...":"Sačuvaj"),9,We)],32)])}o(116);var Oe={data(){return{formData:{physicalDevelopment:"",emotionalDevelopment:"",intellectualDevelopment:"",socialDevelopment:""},currentPeriod:{startAge:null,endAge:null},childBirthDate:null,childAgeInMonths:null,error:null,loading:!1,physicalError:null,emotionalError:null,intellectualError:null,socialError:null,hasErrors:!1}},async created(){console.log("🔄 Component Created: Fetching child and period data..."),await this.initializeForm()},methods:{async initializeForm(){const e=l(),t=e.token,o=e.childId;console.log("📢 Fetching child data...");const a=await E.A.get(`http://localhost:5000/api/${o}`,{headers:{Authorization:`Bearer ${t}`}});if(a.data){this.childBirthDate=a.data.birthDate,this.childAgeInMonths=this.calculateAgeInMonths(this.childBirthDate);const{startAge:e,endAge:t}=this.$route.query;e&&t?this.currentPeriod={startAge:parseInt(e),endAge:parseInt(t)}:this.setCurrentPeriod(this.childAgeInMonths)}console.log("🔍 Fetching existing development data...");const i=await E.A.get(`http://localhost:5000/api/child-development/${o}`,{headers:{Authorization:`Bearer ${t}`}});if(i.data.length>0){const e=i.data.find((e=>e.startAge===this.currentPeriod.startAge&&e.endAge===this.currentPeriod.endAge));e&&(console.log("✅ Found existing data for period:",e),this.formData={...e})}},calculateAgeInMonths(e){const t=new Date(e),o=new Date;return 12*(o.getFullYear()-t.getFullYear())+(o.getMonth()-t.getMonth())},setCurrentPeriod(e){const t=6,o=Math.floor(e/t)*t,a=o+t;this.currentPeriod={startAge:o,endAge:a}},validateInput(e){this.hasErrors=!1;const t=this.formData[e].trim().length;t<5?(this[`${e}Error`]=`Polje ${e} mora imati najmanje 5 karaktera.`,this.hasErrors=!0):this[`${e}Error`]=null},async saveDevelopment(){if(this.hasErrors)this.error="Molimo ispravite greške pre nego što pošaljete podatke.";else try{this.loading=!0;const e=l(),t=e.childId,o=e.token;console.log("📤 Sending development data:",this.formData);const a={startAge:this.currentPeriod.startAge,endAge:this.currentPeriod.endAge,physicalDevelopment:this.formData.physicalDevelopment,emotionalDevelopment:this.formData.emotionalDevelopment,intellectualDevelopment:this.formData.intellectualDevelopment,socialDevelopment:this.formData.socialDevelopment},i=await E.A.post(`http://localhost:5000/api/child-development/${t}`,a,{headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"}});console.log("✅ Development data saved:",i.data),this.$router.push(`/child-development-list/${t}`)}catch(e){console.error("❌ Error saving development:",e),this.error="Greška pri čuvanju podataka."}finally{this.loading=!1}}}};const Be=(0,h.A)(Oe,[["render",qe],["__scopeId","data-v-353d9892"]]);var Ue=Be;const Qe={class:"development-container"},Re={class:"child-info"},Ve={class:"period-selector"},Ke={class:"periods-list"},xe=["onClick","disabled"],Je={key:0},Ge={key:1},Ye={key:2},He={key:3},Ze={key:0,class:"period-data"},et={key:0,class:"development-section"},tt={class:"development-details"},ot={class:"development-item"},at={class:"development-item"},it={class:"development-item"},rt={class:"development-item"},st={class:"button-group"},nt={key:1},lt={key:2,class:"milestones-section"},dt={class:"milestone-list"},ct={class:"button-group"},ht=["onClick"],ut=["onClick"],mt={key:3,class:"no-records"},pt={key:0};function vt(e,t,o,a,r,s){return(0,i.uX)(),(0,i.CE)("div",Qe,[(0,i.Lk)("h2",null,"Praćenje Razvoja za dete "+(0,p.v_)(r.childName||"Nepoznato dete"),1),(0,i.Lk)("div",Re,[(0,i.Lk)("h3",null,(0,p.v_)(r.childName),1),(0,i.Lk)("p",null,[t[5]||(t[5]=(0,i.Lk)("strong",null,"Starost:",-1)),(0,i.eW)(" "+(0,p.v_)(r.childAge?r.childAge+" meseci":"Nepoznata starost"),1)])]),(0,i.Lk)("div",Ve,[t[6]||(t[6]=(0,i.Lk)("h3",null,"Izaberite period:",-1)),(0,i.Lk)("div",Ke,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(r.availablePeriods,(e=>((0,i.uX)(),(0,i.CE)("button",{key:`${e.start}-${e.end}`,class:(0,p.C4)(s.getPeriodClass(e)),onClick:t=>s.selectPeriod(e),disabled:s.isFuturePeriod(e)},[(0,i.eW)((0,p.v_)(s.formatPeriod(e.start,e.end))+" ",1),s.isFilledPeriod(e)?((0,i.uX)(),(0,i.CE)("span",Je,"✔ Ispunjeno")):s.isCurrentPeriod(e)?((0,i.uX)(),(0,i.CE)("span",Ge,"🟢 Trenutni period")):s.isFuturePeriod(e)?((0,i.uX)(),(0,i.CE)("span",Ye,"🚫 Nedostupan")):((0,i.uX)(),(0,i.CE)("span",He,"❌ Neispunjeno"))],10,xe)))),128))])]),r.selectedPeriod?((0,i.uX)(),(0,i.CE)("div",Ze,[(0,i.Lk)("h3",null,"Razvoj za period: "+(0,p.v_)(s.formatPeriod(r.selectedPeriod.start,r.selectedPeriod.end)),1),s.currentPeriodDevelopment?((0,i.uX)(),(0,i.CE)("div",et,[t[11]||(t[11]=(0,i.Lk)("h4",null,"Razvoj deteta",-1)),(0,i.Lk)("div",tt,[(0,i.Lk)("div",ot,[t[7]||(t[7]=(0,i.Lk)("h5",null,"Fizički razvoj",-1)),(0,i.Lk)("p",null,(0,p.v_)(s.currentPeriodDevelopment.physicalDevelopment||"Nema podataka"),1)]),(0,i.Lk)("div",at,[t[8]||(t[8]=(0,i.Lk)("h5",null,"Emocionalni razvoj",-1)),(0,i.Lk)("p",null,(0,p.v_)(s.currentPeriodDevelopment.emotionalDevelopment||"Nema podataka"),1)]),(0,i.Lk)("div",it,[t[9]||(t[9]=(0,i.Lk)("h5",null,"Intelektualni razvoj",-1)),(0,i.Lk)("p",null,(0,p.v_)(s.currentPeriodDevelopment.intellectualDevelopment||"Nema podataka"),1)]),(0,i.Lk)("div",rt,[t[10]||(t[10]=(0,i.Lk)("h5",null,"Socijalni razvoj",-1)),(0,i.Lk)("p",null,(0,p.v_)(s.currentPeriodDevelopment.socialDevelopment||"Nema podataka"),1)]),(0,i.Lk)("div",st,[(0,i.Lk)("button",{onClick:t[0]||(t[0]=e=>s.editDevelopment(s.currentPeriodDevelopment)),class:"edit-btn"},"Izmeni"),(0,i.Lk)("button",{onClick:t[1]||(t[1]=e=>s.confirmDeleteDevelopment(s.currentPeriodDevelopment._id)),class:"delete-btn"},"Obriši")])])])):((0,i.uX)(),(0,i.CE)("div",nt,[s.isFilledPeriod(r.selectedPeriod)?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("button",{key:0,onClick:t[2]||(t[2]=e=>s.navigateToDevelopmentForm(r.selectedPeriod)),class:"add-development-btn"},"Dodaj Razvoj"))])),s.currentPeriodMilestones.length?((0,i.uX)(),(0,i.CE)("div",lt,[t[14]||(t[14]=(0,i.Lk)("h4",null,"Ključni momenti za ovaj period",-1)),(0,i.Lk)("div",dt,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(s.currentPeriodMilestones,(e=>((0,i.uX)(),(0,i.CE)("div",{key:e._id,class:"milestone-item"},[(0,i.Lk)("h3",null,(0,p.v_)(e.milestoneType)+" - "+(0,p.v_)(s.formatDate(e.milestoneDate)),1),(0,i.Lk)("p",null,[t[12]||(t[12]=(0,i.Lk)("strong",null,"Napredak:",-1)),(0,i.eW)(" "+(0,p.v_)(e.progress),1)]),(0,i.Lk)("p",null,[t[13]||(t[13]=(0,i.Lk)("strong",null,"Napomene:",-1)),(0,i.eW)(" "+(0,p.v_)(e.notes),1)]),(0,i.Lk)("div",ct,[(0,i.Lk)("button",{onClick:t=>s.editMilestone(e),class:"edit-btn"},"Izmeni",8,ht),(0,i.Lk)("button",{onClick:t=>s.confirmDeleteMilestone(e._id),class:"delete-btn"},"Obriši",8,ut)])])))),128))])])):((0,i.uX)(),(0,i.CE)("div",mt,[s.isFilledPeriod(r.selectedPeriod)?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("p",pt,"Nema unetih podataka za ovaj period.")),s.isFilledPeriod(r.selectedPeriod)?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("button",{key:1,onClick:t[3]||(t[3]=e=>s.navigateToDevelopmentForm(r.selectedPeriod)),class:"add-development-btn"},"Dodaj Razvoj")),s.currentPeriodMilestones.length?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("button",{key:2,onClick:t[4]||(t[4]=(...e)=>s.navigateToMilestoneForm&&s.navigateToMilestoneForm(...e)),class:"add-milestone-btn"},"Dodaj Ključni Momenat"))]))])):(0,i.Q3)("",!0)])}o(3579);var gt={data(){return{childName:null,childAge:null,developmentData:[],milestoneData:[],availablePeriods:[],selectedPeriod:null,childBirthDate:null}},computed:{currentPeriodDevelopment(){return this.selectedPeriod?this.developmentData.find((e=>e.startAge===this.selectedPeriod.start&&e.endAge===this.selectedPeriod.end)):null},currentPeriodMilestones(){if(!this.selectedPeriod)return[];const e=this.getMilestonesForPeriod(this.selectedPeriod);return console.log("📢 Current Period Milestones:",e),e}},methods:{async fetchChildData(e){try{const t=l(),o=t.token;console.log("🔍 Fetching child data for:",e);const a=await E.A.get(`http://localhost:5000/api/${e}`,{headers:{Authorization:`Bearer ${o}`}});a.data&&(this.childName=a.data.name,this.childAge=this.calculateAgeInMonths(a.data.birthDate),this.childBirthDate=a.data.birthDate,this.generateAvailablePeriods())}catch(t){console.error("❌ Error fetching child data:",t)}},async fetchDevelopmentData(e){try{const t=l(),o=t.token;console.log("📢 Fetching development data for:",e);const a=await E.A.get(`http://localhost:5000/api/child-development/${e}`,{headers:{Authorization:`Bearer ${o}`}});this.developmentData=a.data||[]}catch(t){console.error("❌ Error fetching development data:",t)}},async fetchMilestones(e){try{const t=l(),o=t.token;console.log("📢 Fetching milestones for:",e);const a=await E.A.get(`http://localhost:5000/api/milestones/${e}`,{headers:{Authorization:`Bearer ${o}`}});this.milestoneData=a.data||[],console.log("✅ Fetched Milestones:",this.milestoneData)}catch(t){console.error("❌ Error fetching milestones:",t)}},getMilestonesForPeriod(e){if(!this.childBirthDate)return console.warn("⚠️ Child birth date is missing, cannot filter milestones."),[];const t=new Date(this.childBirthDate),o=new Date(t);o.setMonth(o.getMonth()+e.start);const a=new Date(t);a.setMonth(a.getMonth()+e.end),console.log(`🔎 Filtering milestones between ${o.toISOString()} - ${a.toISOString()}`);const i=this.milestoneData.filter((e=>{const t=new Date(e.milestoneDate);return console.log(`🔍 Checking Milestone: ${e.milestoneType} - ${t.toISOString()}`),t>=o&&t<a}));return console.log("📌 Matched Milestones for Period:",i),i},calculateStartDate(e){const t=new Date(this.childBirthDate);return t.setMonth(t.getMonth()+e),t},calculateEndDate(e){const t=new Date(this.childBirthDate);return t.setMonth(t.getMonth()+e),t},calculateAgeInMonths(e){if(!e)return 0;const t=new Date(e),o=new Date;return 12*(o.getFullYear()-t.getFullYear())+(o.getMonth()-t.getMonth())},generateAvailablePeriods(){if(null!==this.childAge){this.availablePeriods=[];for(let e=0;e<=72;e+=6)this.availablePeriods.push({start:e,end:e+6})}},async selectPeriod(e){this.selectedPeriod=e,console.log("🔍 Selected Period:",e),await this.fetchMilestones(this.$route.params.childId),this.$forceUpdate()},formatPeriod(e,t){return`${e}-${t} meseci`},formatDate(e){return new Date(e).toLocaleDateString("sr-RS")},getPeriodClass(e){return this.isCurrentPeriod(e)?"period-button current":this.isFilledPeriod(e)?"period-button filled":this.isFuturePeriod(e)?"period-button future":"period-button past"},isCurrentPeriod(e){return this.childAge>=e.start&&this.childAge<e.end},isFilledPeriod(e){return this.developmentData.some((t=>t.startAge===e.start&&t.endAge===e.end))},isFuturePeriod(e){return this.childAge<e.start},navigateToDevelopmentForm(e){this.$router.push({path:`/child-development-form/${this.$route.params.childId}`,query:{startAge:e.start,endAge:e.end}})},navigateToMilestoneForm(){this.$router.push({path:`/milestone-form/${this.$route.params.childId}`})},async confirmDeleteDevelopment(e){window.confirm("Da li ste sigurni da želite da obrišete ove podatke o razvoju?")&&await this.deleteDevelopment(e)},async deleteDevelopment(e){try{const t=l(),o=t.token,a=this.$route.params.childId;await E.A.delete(`http://localhost:5000/api/child-development/${a}/${e}`,{headers:{Authorization:`Bearer ${o}`}}),await this.fetchDevelopmentData(a),await this.fetchMilestones(a)}catch(t){console.error("❌ Error deleting development data:",t)}},editDevelopment(e){e?(console.log("✏️ Editing development:",e),this.$router.push({path:`/child-development-form/${this.$route.params.childId}`,query:{startAge:e.startAge,endAge:e.endAge}})):console.warn("⚠️ No development data available to edit.")},editMilestone(e){e?(console.log("✏️ Editing milestone:",e),this.$router.push({path:`/milestone-form/${this.$route.params.childId}`,query:{milestoneId:e._id}})):console.warn("⚠️ No milestone data available to edit.")},async confirmDeleteMilestone(e){window.confirm("Da li ste sigurni da želite da obrišete ovaj ključni trenutak?")&&await this.deleteMilestone(e)},async deleteMilestone(e){try{const t=l(),o=t.token,a=this.$route.params.childId;await E.A.delete(`http://localhost:5000/api/milestones/${e}`,{headers:{Authorization:`Bearer ${o}`}}),await this.fetchMilestones(a),this.$forceUpdate()}catch(t){console.error("❌ Error deleting milestone:",t)}}},async created(){try{const e=this.$route.params.childId;e&&(console.log("🚀 Fetching data for child:",e),await this.fetchChildData(e),await this.fetchDevelopmentData(e),await this.fetchMilestones(e))}catch(e){console.error("❌ Error in created():",e)}}};const kt=(0,h.A)(gt,[["render",vt],["__scopeId","data-v-45e8eb6c"]]);var ft=kt;const bt={class:"development-container"},Dt={class:"period-selector"},yt={class:"periods-list"},It=["onClick","disabled"];function Ct(e,t,o,a,r,s){return(0,i.uX)(),(0,i.CE)("div",bt,[(0,i.Lk)("h2",null,"Praćenje Razvoja za "+(0,p.v_)(r.childName||"Nepoznato dete"),1),(0,i.Lk)("div",Dt,[t[0]||(t[0]=(0,i.Lk)("h3",null,"Izaberite period:",-1)),(0,i.Lk)("div",yt,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(r.availablePeriods,(e=>((0,i.uX)(),(0,i.CE)("button",{key:`${e.start}-${e.end}`,class:(0,p.C4)(s.getPeriodClass(e)),onClick:t=>s.selectPeriod(e),disabled:s.isFuturePeriod(e)},(0,p.v_)(s.formatPeriod(e.start,e.end)),11,It)))),128))])])])}var Et={emits:["period-selected"],data(){return{childName:null,childAge:null,availablePeriods:[]}},methods:{async fetchChildData(e){try{const t=sessionStorage.getItem("token"),o=await E.A.get(`http://localhost:5000/api/${e}`,{headers:{Authorization:`Bearer ${t}`}});this.childName=o.data.name,this.childAge=this.calculateAgeInMonths(o.data.birthDate),this.generateAvailablePeriods()}catch(t){console.error("❌ Greška pri dobijanju podataka o detetu:",t)}},calculateAgeInMonths(e){const t=new Date(e),o=new Date;return 12*(o.getFullYear()-t.getFullYear())+(o.getMonth()-t.getMonth())},generateAvailablePeriods(){if(null!==this.childAge){this.availablePeriods=[];for(let e=0;e<=72;e+=6)this.availablePeriods.push({start:e,end:e+6})}},selectPeriod(e){console.log("🔵 Selected Period:",e),this.$emit("period-selected",e)},formatPeriod(e,t){return`${e}-${t} meseci`},getPeriodClass(e){return console.log("🔍 Checking Class for:",e),this.isCurrentPeriod(e)?"period-button current":this.isFilledPeriod(e)?"period-button filled":this.isFuturePeriod(e)?"period-button future":"period-button past"},isCurrentPeriod(e){return this.childAge>=e.start&&this.childAge<e.end},isFilledPeriod(e){return this.childAge>=e.end},isFuturePeriod(e){return this.childAge<e.start}},async created(){const e=this.$route.params.childId;e&&await this.fetchChildData(e)}};const Lt=(0,h.A)(Et,[["render",Ct]]);var At=Lt;const jt={class:"registration-container"},Pt={key:0,class:"error-message"},_t={class:"dashboard-link"};function wt(e,t,o,r,s,n){const l=(0,i.g2)("router-link");return(0,i.uX)(),(0,i.CE)("div",jt,[t[5]||(t[5]=(0,i.Lk)("h2",null,"Registracija Deteta",-1)),s.errorMessage?((0,i.uX)(),(0,i.CE)("div",Pt,(0,p.v_)(s.errorMessage),1)):(0,i.Q3)("",!0),(0,i.Lk)("form",{onSubmit:t[2]||(t[2]=(0,a.D$)(((...e)=>n.registerChild&&n.registerChild(...e)),["prevent"]))},[(0,i.bo)((0,i.Lk)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>s.name=e),placeholder:"Ime deteta",required:""},null,512),[[a.Jo,s.name]]),(0,i.bo)((0,i.Lk)("input",{type:"date","onUpdate:modelValue":t[1]||(t[1]=e=>s.birthdate=e),required:""},null,512),[[a.Jo,s.birthdate]]),t[3]||(t[3]=(0,i.Lk)("button",{type:"submit"},"Registruj Dete",-1))],32),(0,i.Lk)("div",_t,[(0,i.bF)(l,{to:"/dashboard"},{default:(0,i.k6)((()=>t[4]||(t[4]=[(0,i.eW)("Idi na Dashboard")]))),_:1})])])}var $t={data(){return{name:"",birthdate:"",errorMessage:""}},methods:{async registerChild(){try{const e=l(),t=await E.A.post("http://localhost:5000/api/",{name:this.name,birthDate:this.birthdate},{headers:{Authorization:`Bearer ${sessionStorage.getItem("token")}`}});t.data&&t.data._id?(console.log("✅ Dete registrovano:",t.data),e.addChildId(t.data._id),e.setCurrentChildId(t.data._id),sessionStorage.setItem("childId",t.data._id),this.$router.push("/dashboard")):this.errorMessage="Greška prilikom registracije deteta."}catch(e){console.error("❌ Greška pri registraciji deteta:",e),this.errorMessage="Neuspešna registracija. Pokušajte ponovo."}}}};const Mt=(0,h.A)($t,[["render",wt],["__scopeId","data-v-2123cec2"]]);var zt=Mt;const Ft={class:"overview-container"},St={key:0},Xt={key:1,class:"error-message"},Nt={key:2},Tt={key:0,class:"select-container"},Wt=["value"],qt={key:0,class:"error-message"},Ot={key:1,class:"development-table"},Bt={key:2,class:"error-message"},Ut={key:3,class:"milestone-table"},Qt={key:4,class:"error-message"},Rt=["disabled"];function Vt(e,t,o,r,s,n){return(0,i.uX)(),(0,i.CE)("div",Ft,[(0,i.Lk)("h2",null,"Pregled razvoja deteta - "+(0,p.v_)(s.child.name||"Nepoznato dete"),1),s.loading?((0,i.uX)(),(0,i.CE)("div",St,"Učitavanje podataka...")):s.errorMessage?((0,i.uX)(),(0,i.CE)("div",Xt,(0,p.v_)(s.errorMessage),1)):((0,i.uX)(),(0,i.CE)("div",Nt,[s.children.length>0?((0,i.uX)(),(0,i.CE)("div",Tt,[t[3]||(t[3]=(0,i.Lk)("label",{for:"child-select"},"Izaberite dete:",-1)),(0,i.bo)((0,i.Lk)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>s.selectedChildId=e),onChange:t[1]||(t[1]=(...e)=>n.onChildSelect&&n.onChildSelect(...e))},[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(s.children,(e=>((0,i.uX)(),(0,i.CE)("option",{key:e._id,value:e._id},(0,p.v_)(e.name),9,Wt)))),128))],544),[[a.u1,s.selectedChildId]]),s.selectedChildId&&!s.child?((0,i.uX)(),(0,i.CE)("div",qt,"Izaberite dete kako biste videli podatke.")):(0,i.Q3)("",!0)])):(0,i.Q3)("",!0),t[6]||(t[6]=(0,i.Lk)("h3",null,"Razvoj deteta",-1)),s.developmentData.length>0?((0,i.uX)(),(0,i.CE)("table",Ot,[t[4]||(t[4]=(0,i.Lk)("thead",null,[(0,i.Lk)("tr",null,[(0,i.Lk)("th",null,"Period"),(0,i.Lk)("th",null,"Fizički razvoj"),(0,i.Lk)("th",null,"Emocionalni razvoj"),(0,i.Lk)("th",null,"Intelektualni razvoj"),(0,i.Lk)("th",null,"Socijalni razvoj")])],-1)),(0,i.Lk)("tbody",null,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(s.developmentData,(e=>((0,i.uX)(),(0,i.CE)("tr",{key:e.startAge},[(0,i.Lk)("td",null,(0,p.v_)(e.startAge)+" - "+(0,p.v_)(e.endAge)+" meseci",1),(0,i.Lk)("td",null,(0,p.v_)(e.physicalDevelopment||"-"),1),(0,i.Lk)("td",null,(0,p.v_)(e.emotionalDevelopment||"-"),1),(0,i.Lk)("td",null,(0,p.v_)(e.intellectualDevelopment||"-"),1),(0,i.Lk)("td",null,(0,p.v_)(e.socialDevelopment||"-"),1)])))),128))])])):((0,i.uX)(),(0,i.CE)("div",Bt,"Nema podataka o razvoju za ovo dete.")),t[7]||(t[7]=(0,i.Lk)("h3",null,"Ključni momenti",-1)),s.milestoneData.length>0?((0,i.uX)(),(0,i.CE)("table",Ut,[t[5]||(t[5]=(0,i.Lk)("thead",null,[(0,i.Lk)("tr",null,[(0,i.Lk)("th",null,"Tip momenta"),(0,i.Lk)("th",null,"Datum"),(0,i.Lk)("th",null,"Napredak"),(0,i.Lk)("th",null,"Napomene")])],-1)),(0,i.Lk)("tbody",null,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(s.milestoneData,(e=>((0,i.uX)(),(0,i.CE)("tr",{key:e._id},[(0,i.Lk)("td",null,(0,p.v_)(e.milestoneType),1),(0,i.Lk)("td",null,(0,p.v_)(n.formatDate(e.milestoneDate)),1),(0,i.Lk)("td",null,(0,p.v_)(e.progress||"-"),1),(0,i.Lk)("td",null,(0,p.v_)(e.notes||"-"),1)])))),128))])])):((0,i.uX)(),(0,i.CE)("div",Qt,"Nema ključnih momenata za ovo dete.")),(0,i.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>n.downloadPDF&&n.downloadPDF(...e)),class:"pdf-button",disabled:!s.developmentData.length||!s.milestoneData.length},"Preuzmi PDF",8,Rt)]))])}var Kt=o(4323),xt=o(5708),Jt={data(){return{children:[],selectedChildId:"",child:{},developmentData:[],milestoneData:[],loading:!0,errorMessage:""}},async created(){await this.fetchChildren()},methods:{formatDate(e){return new Date(e).toLocaleDateString("sr-RS")},async fetchChildren(){try{const e=sessionStorage.getItem("token"),t=await E.A.get("http://localhost:5000/api/",{headers:{Authorization:`Bearer ${e}`}});this.children=t.data,console.log("Lista dece učitana:",this.children);const o=l();o.childId?this.selectedChildId=o.childId:this.children.length>0&&(this.selectedChildId=this.children[0]._id,o.setCurrentChildId(this.selectedChildId)),await this.fetchChildData(this.selectedChildId),await this.fetchDevelopmentData(this.selectedChildId),await this.fetchMilestones(this.selectedChildId)}catch(e){console.error("❌ Greška pri učitavanju dece:",e),this.errorMessage="Nije moguće učitati listu dece."}finally{this.loading=!1}},async fetchChildData(e){try{const t=sessionStorage.getItem("token"),o=await E.A.get(`http://localhost:5000/api/${e}`,{headers:{Authorization:`Bearer ${t}`}});if(!o.data||0===Object.keys(o.data).length)return void(this.errorMessage="Podaci o detetu nisu pronađeni.");this.child=o.data,console.log("Podaci o detetu:",this.child)}catch(t){console.error("❌ Greška pri dobijanju podataka o detetu:",t),this.errorMessage="Nije moguće učitati podatke o detetu."}},async fetchDevelopmentData(e){try{const t=sessionStorage.getItem("token"),o=await E.A.get(`http://localhost:5000/api/child-development/${e}`,{headers:{Authorization:`Bearer ${t}`}});this.developmentData=o.data||[]}catch(t){console.error("❌ Greška pri dobijanju podataka o razvoju:",t),this.errorMessage="Nije moguće učitati razvojne podatke."}},async fetchMilestones(e){try{const t=sessionStorage.getItem("token"),o=await E.A.get(`http://localhost:5000/api/milestones/${e}`,{headers:{Authorization:`Bearer ${t}`}});this.milestoneData=o.data||[]}catch(t){console.error("❌ Greška pri dobijanju ključnih momenata:",t)}},async onChildSelect(){console.log("Odabrano dete ID:",this.selectedChildId);const e=l();e.setCurrentChildId(this.selectedChildId),await this.fetchChildData(this.selectedChildId),await this.fetchDevelopmentData(this.selectedChildId),await this.fetchMilestones(this.selectedChildId)},downloadPDF(){const e=new Kt.uE;e.setFont("FreeSerif"),e.text(`Razvoj deteta: ${this.child.name}`,10,10);const t=[["Period","Fizicki","Emocionalni","Intelektualni","Socijalni"],...this.developmentData.map((e=>[`${e.startAge}-${e.endAge} meseci`,e.physicalDevelopment||"-",e.emotionalDevelopment||"-",e.intellectualDevelopment||"-",e.socialDevelopment||"-"]))],o=[["Tip momenta","Datum","Napredak","Napomene"],...this.milestoneData.map((e=>[e.milestoneType,this.formatDate(e.milestoneDate),e.progress||"-",e.notes||"-"]))];(0,xt.Ay)(e,{head:[t[0]],body:t.slice(1),startY:20}),(0,xt.Ay)(e,{head:[o[0]],body:o.slice(1),startY:e.lastAutoTable.finalY+10}),e.save(`Razvoj_${this.child.name}.pdf`)}}};const Gt=(0,h.A)(Jt,[["render",Vt],["__scopeId","data-v-daf46852"]]);var Yt=Gt;const Ht=[{path:"/",component:q,name:"signup",meta:{requiresAuth:!1,guestOnly:!0}},{path:"/login",component:J,name:"login",meta:{requiresAuth:!1,guestOnly:!0}},{path:"/dashboard",component:P,name:"dashboard",meta:{requiresAuth:!0}},{path:"/child-registration",component:zt,name:"child-registration",meta:{requiresAuth:!0}},{path:"/milestone-form/:childId/:milestoneId?",component:fe,name:"milestone-form",meta:{requiresAuth:!0,requiresChild:!0},props:!0},{path:"/milestone-list/:childId",component:Pe,name:"milestone-list",meta:{requiresAuth:!0,requiresChild:!0},props:!0},{path:"/child-development-list/:childId",component:ft,name:"ChildDevelopmentList",meta:{requiresAuth:!0,requiresChild:!0},props:!0},{path:"/child-development-page/:childId",component:ie,name:"child-development-page",meta:{requiresAuth:!0,requiresChild:!0},props:!0},{path:"/period",component:At,name:"period",meta:{requiresAuth:!0,requiresChild:!0},props:!0},{path:"/child-overview/:childId",component:Yt,name:"child-overview",meta:{requiresAuth:!0,requiresChild:!0},props:!0},{path:"/add-development/:childId",name:"AddDevelopmentData",component:Ue},{path:"/add-milestone/:childId",name:"AddMilestone",component:fe},{path:"/child-development-form/:childId",name:"ChildDevelopmentForm",component:Ue},{path:"/child-development/:childId",name:"child-development",component:Ue,props:!0,meta:{requiresAuth:!0}},{path:"/child-development-list/:childId",name:"ChildDevelopmentList",component:ft}],Zt=(0,d.aE)({history:(0,d.LA)(),routes:Ht});Zt.beforeEach(((e,t,o)=>{const a=l();!e.meta.requiresAuth||a.isAuthenticated?e.meta.guestOnly&&a.isAuthenticated?o("/dashboard"):!e.meta.requiresChild||a.hasChild?o():o("/child-registration"):o("/login")}));var eo=Zt;const to=(0,a.Ef)(m);to.use((0,n.Ey)()),to.use(eo),to.mount("#app")}},t={};function o(a){var i=t[a];if(void 0!==i)return i.exports;var r=t[a]={exports:{}};return e[a].call(r.exports,r,r.exports,o),r.exports}o.m=e,function(){var e=[];o.O=function(t,a,i,r){if(!a){var s=1/0;for(c=0;c<e.length;c++){a=e[c][0],i=e[c][1],r=e[c][2];for(var n=!0,l=0;l<a.length;l++)(!1&r||s>=r)&&Object.keys(o.O).every((function(e){return o.O[e](a[l])}))?a.splice(l--,1):(n=!1,r<s&&(s=r));if(n){e.splice(c--,1);var d=i();void 0!==d&&(t=d)}}return t}r=r||0;for(var c=e.length;c>0&&e[c-1][2]>r;c--)e[c]=e[c-1];e[c]=[a,i,r]}}(),function(){var e,t=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__};o.t=function(a,i){if(1&i&&(a=this(a)),8&i)return a;if("object"===typeof a&&a){if(4&i&&a.__esModule)return a;if(16&i&&"function"===typeof a.then)return a}var r=Object.create(null);o.r(r);var s={};e=e||[null,t({}),t([]),t(t)];for(var n=2&i&&a;"object"==typeof n&&!~e.indexOf(n);n=t(n))Object.getOwnPropertyNames(n).forEach((function(e){s[e]=function(){return a[e]}}));return s["default"]=function(){return a},o.d(r,s),r}}(),function(){o.d=function(e,t){for(var a in t)o.o(t,a)&&!o.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){o.f={},o.e=function(e){return Promise.all(Object.keys(o.f).reduce((function(t,a){return o.f[a](e,t),t}),[]))}}(),function(){o.u=function(e){return"js/"+e+"."+{354:"326584b3",418:"ad2b835a",668:"3b9619f2"}[e]+".js"}}(),function(){o.miniCssF=function(e){}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="basic-booklet:";o.l=function(a,i,r,s){if(e[a])e[a].push(i);else{var n,l;if(void 0!==r)for(var d=document.getElementsByTagName("script"),c=0;c<d.length;c++){var h=d[c];if(h.getAttribute("src")==a||h.getAttribute("data-webpack")==t+r){n=h;break}}n||(l=!0,n=document.createElement("script"),n.charset="utf-8",n.timeout=120,o.nc&&n.setAttribute("nonce",o.nc),n.setAttribute("data-webpack",t+r),n.src=a),e[a]=[i];var u=function(t,o){n.onerror=n.onload=null,clearTimeout(m);var i=e[a];if(delete e[a],n.parentNode&&n.parentNode.removeChild(n),i&&i.forEach((function(e){return e(o)})),t)return t(o)},m=setTimeout(u.bind(null,void 0,{type:"timeout",target:n}),12e4);n.onerror=u.bind(null,n.onerror),n.onload=u.bind(null,n.onload),l&&document.head.appendChild(n)}}}(),function(){o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){o.p="/"}(),function(){var e={524:0};o.f.j=function(t,a){var i=o.o(e,t)?e[t]:void 0;if(0!==i)if(i)a.push(i[2]);else{var r=new Promise((function(o,a){i=e[t]=[o,a]}));a.push(i[2]=r);var s=o.p+o.u(t),n=new Error,l=function(a){if(o.o(e,t)&&(i=e[t],0!==i&&(e[t]=void 0),i)){var r=a&&("load"===a.type?"missing":a.type),s=a&&a.target&&a.target.src;n.message="Loading chunk "+t+" failed.\n("+r+": "+s+")",n.name="ChunkLoadError",n.type=r,n.request=s,i[1](n)}};o.l(s,l,"chunk-"+t,t)}},o.O.j=function(t){return 0===e[t]};var t=function(t,a){var i,r,s=a[0],n=a[1],l=a[2],d=0;if(s.some((function(t){return 0!==e[t]}))){for(i in n)o.o(n,i)&&(o.m[i]=n[i]);if(l)var c=l(o)}for(t&&t(a);d<s.length;d++)r=s[d],o.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return o.O(c)},a=self["webpackChunkbasic_booklet"]=self["webpackChunkbasic_booklet"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=o.O(void 0,[504],(function(){return o(2887)}));a=o.O(a)})();
//# sourceMappingURL=app.3ff39818.js.map