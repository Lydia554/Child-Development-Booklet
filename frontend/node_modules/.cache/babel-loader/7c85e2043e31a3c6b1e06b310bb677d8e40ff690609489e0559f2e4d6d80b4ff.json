{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.find.js\";\nimport axios from 'axios';\nexport default {\n  data() {\n    return {\n      newDevelopment: {\n        physicalDevelopment: '',\n        emotionalDevelopment: '',\n        intellectualDevelopment: '',\n        socialDevelopment: ''\n      },\n      errorMessage: '',\n      childAge: 0,\n      startAge: 0,\n      endAge: 6\n    };\n  },\n  computed: {\n    isPeriodAvailable() {\n      // Allow entry for current and past periods\n      return this.childAge >= this.startAge;\n    },\n    submitButtonText() {\n      if (!this.isPeriodAvailable) {\n        return 'Period još nije dostupan';\n      }\n      return 'Sačuvaj';\n    }\n  },\n  async created() {\n    const childId = this.$route.params.childId;\n    const startAge = parseInt(this.$route.query.start) || 0;\n    const endAge = parseInt(this.$route.query.end) || 6;\n    if (!childId) {\n      this.errorMessage = 'Nedostaje ID deteta.';\n      this.$router.push('/child-registration');\n      return;\n    }\n    this.startAge = startAge;\n    this.endAge = endAge;\n    await this.fetchChildAge(childId);\n    await this.fetchExistingData(childId);\n  },\n  methods: {\n    async fetchChildAge(childId) {\n      try {\n        const token = sessionStorage.getItem('token');\n        const response = await axios.get(`http://localhost:5000/api/children/${childId}`, {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        const birthDate = new Date(response.data.birthDate);\n        const now = new Date();\n        this.childAge = (now.getFullYear() - birthDate.getFullYear()) * 12 + (now.getMonth() - birthDate.getMonth());\n        if (now.getDate() < birthDate.getDate()) {\n          this.childAge--;\n        }\n\n        // Redirect if trying to access a future period\n        if (this.childAge < this.startAge) {\n          this.errorMessage = 'Ovaj period još nije dostupan.';\n          setTimeout(() => {\n            this.$router.push(`/child-development-list/${childId}`);\n          }, 2000);\n        }\n      } catch (error) {\n        console.error('Error fetching child age:', error);\n        this.errorMessage = 'Greška pri učitavanju podataka o detetu.';\n      }\n    },\n    async fetchExistingData(childId) {\n      try {\n        const token = sessionStorage.getItem('token');\n        const response = await axios.get(`http://localhost:5000/api/child-development/${childId}`, {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        if (response.data && response.data.periods) {\n          const existingPeriod = response.data.periods.find(period => period.startAge === this.startAge && period.endAge === this.endAge);\n          if (existingPeriod) {\n            this.newDevelopment = {\n              physicalDevelopment: existingPeriod.physicalDevelopment,\n              emotionalDevelopment: existingPeriod.emotionalDevelopment,\n              intellectualDevelopment: existingPeriod.intellectualDevelopment,\n              socialDevelopment: existingPeriod.socialDevelopment\n            };\n          }\n        }\n      } catch (error) {\n        console.error('Error fetching existing data:', error);\n      }\n    },\n    formatPeriod(start, end) {\n      if (start === 0) {\n        return `0-6 meseci`;\n      }\n      return `${start}-${end} meseci`;\n    },\n    async submitDevelopmentForm() {\n      try {\n        const token = sessionStorage.getItem('token');\n        if (!token) {\n          this.errorMessage = 'Morate biti ulogovani.';\n          return;\n        }\n        const childId = this.$route.params.childId;\n        const developmentData = {\n          ...this.newDevelopment,\n          startAge: this.startAge,\n          endAge: this.endAge\n        };\n        await axios.post(`http://localhost:5000/api/child-development/${childId}`, developmentData, {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        this.$router.push(`/child-development-list/${childId}`);\n      } catch (error) {\n        console.error('Error submitting development data:', error);\n        this.errorMessage = 'Greška prilikom čuvanja podataka.';\n      }\n    }\n  }\n};","map":{"version":3,"names":["axios","data","newDevelopment","physicalDevelopment","emotionalDevelopment","intellectualDevelopment","socialDevelopment","errorMessage","childAge","startAge","endAge","computed","isPeriodAvailable","submitButtonText","created","childId","$route","params","parseInt","query","start","end","$router","push","fetchChildAge","fetchExistingData","methods","token","sessionStorage","getItem","response","get","headers","Authorization","birthDate","Date","now","getFullYear","getMonth","getDate","setTimeout","error","console","periods","existingPeriod","find","period","formatPeriod","submitDevelopmentForm","developmentData","post"],"sources":["C:\\Users\\goldb\\Pro\\Project\\basic-booklet\\frontend\\src\\components\\ChildDevelopmentForm.vue"],"sourcesContent":["<template>\r\n  <div class=\"child-development-form\">\r\n    <h2>Unos Razvoja Deteta</h2>\r\n    <h3>Period: {{ formatPeriod(startAge, endAge) }}</h3>\r\n    \r\n    <form @submit.prevent=\"submitDevelopmentForm\" class=\"form-container\">\r\n      <div class=\"form-group\">\r\n        <label for=\"physicalDevelopment\">Fizički razvoj:</label>\r\n        <textarea v-model=\"newDevelopment.physicalDevelopment\" required class=\"form-input\"></textarea>\r\n      </div>\r\n      <div class=\"form-group\">\r\n        <label for=\"emotionalDevelopment\">Emocionalni razvoj:</label>\r\n        <textarea v-model=\"newDevelopment.emotionalDevelopment\" required class=\"form-input\"></textarea>\r\n      </div>\r\n      <div class=\"form-group\">\r\n        <label for=\"intellectualDevelopment\">Intelektualni razvoj:</label>\r\n        <textarea v-model=\"newDevelopment.intellectualDevelopment\" required class=\"form-input\"></textarea>\r\n      </div>\r\n      <div class=\"form-group\">\r\n        <label for=\"socialDevelopment\">Socijalni razvoj:</label>\r\n        <textarea v-model=\"newDevelopment.socialDevelopment\" required class=\"form-input\"></textarea>\r\n      </div>\r\n      <button type=\"submit\" class=\"submit-btn\" :disabled=\"!isPeriodAvailable\">\r\n        {{ submitButtonText }}\r\n      </button>\r\n    </form>\r\n\r\n    <div v-if=\"errorMessage\" class=\"error-message\">{{ errorMessage }}</div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios';\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      newDevelopment: {\r\n        physicalDevelopment: '',\r\n        emotionalDevelopment: '',\r\n        intellectualDevelopment: '',\r\n        socialDevelopment: ''\r\n      },\r\n      errorMessage: '',\r\n      childAge: 0,\r\n      startAge: 0,\r\n      endAge: 6\r\n    };\r\n  },\r\n\r\n  computed: {\r\n    isPeriodAvailable() {\r\n      // Allow entry for current and past periods\r\n      return this.childAge >= this.startAge;\r\n    },\r\n\r\n    submitButtonText() {\r\n      if (!this.isPeriodAvailable) {\r\n        return 'Period još nije dostupan';\r\n      }\r\n      return 'Sačuvaj';\r\n    }\r\n  },\r\n\r\n  async created() {\r\n    const childId = this.$route.params.childId;\r\n    const startAge = parseInt(this.$route.query.start) || 0;\r\n    const endAge = parseInt(this.$route.query.end) || 6;\r\n\r\n    if (!childId) {\r\n      this.errorMessage = 'Nedostaje ID deteta.';\r\n      this.$router.push('/child-registration');\r\n      return;\r\n    }\r\n\r\n    this.startAge = startAge;\r\n    this.endAge = endAge;\r\n\r\n    await this.fetchChildAge(childId);\r\n    await this.fetchExistingData(childId);\r\n  },\r\n\r\n  methods: {\r\n    async fetchChildAge(childId) {\r\n      try {\r\n        const token = sessionStorage.getItem('token');\r\n        const response = await axios.get(\r\n          `http://localhost:5000/api/children/${childId}`,\r\n          {\r\n            headers: { Authorization: `Bearer ${token}` }\r\n          }\r\n        );\r\n        \r\n        const birthDate = new Date(response.data.birthDate);\r\n        const now = new Date();\r\n        this.childAge = (now.getFullYear() - birthDate.getFullYear()) * 12 + \r\n                       (now.getMonth() - birthDate.getMonth());\r\n        \r\n        if (now.getDate() < birthDate.getDate()) {\r\n          this.childAge--;\r\n        }\r\n\r\n        // Redirect if trying to access a future period\r\n        if (this.childAge < this.startAge) {\r\n          this.errorMessage = 'Ovaj period još nije dostupan.';\r\n          setTimeout(() => {\r\n            this.$router.push(`/child-development-list/${childId}`);\r\n          }, 2000);\r\n        }\r\n      } catch (error) {\r\n        console.error('Error fetching child age:', error);\r\n        this.errorMessage = 'Greška pri učitavanju podataka o detetu.';\r\n      }\r\n    },\r\n\r\n    async fetchExistingData(childId) {\r\n      try {\r\n        const token = sessionStorage.getItem('token');\r\n        const response = await axios.get(\r\n          `http://localhost:5000/api/child-development/${childId}`,\r\n          {\r\n            headers: { Authorization: `Bearer ${token}` }\r\n          }\r\n        );\r\n\r\n        if (response.data && response.data.periods) {\r\n          const existingPeriod = response.data.periods.find(\r\n            period => period.startAge === this.startAge && period.endAge === this.endAge\r\n          );\r\n\r\n          if (existingPeriod) {\r\n            this.newDevelopment = {\r\n              physicalDevelopment: existingPeriod.physicalDevelopment,\r\n              emotionalDevelopment: existingPeriod.emotionalDevelopment,\r\n              intellectualDevelopment: existingPeriod.intellectualDevelopment,\r\n              socialDevelopment: existingPeriod.socialDevelopment\r\n            };\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.error('Error fetching existing data:', error);\r\n      }\r\n    },\r\n\r\n    formatPeriod(start, end) {\r\n      if (start === 0) {\r\n        return `0-6 meseci`;\r\n      }\r\n      return `${start}-${end} meseci`;\r\n    },\r\n\r\n    async submitDevelopmentForm() {\r\n      try {\r\n        const token = sessionStorage.getItem('token');\r\n        if (!token) {\r\n          this.errorMessage = 'Morate biti ulogovani.';\r\n          return;\r\n        }\r\n\r\n        const childId = this.$route.params.childId;\r\n        const developmentData = {\r\n          ...this.newDevelopment,\r\n          startAge: this.startAge,\r\n          endAge: this.endAge\r\n        };\r\n\r\n        await axios.post(\r\n          `http://localhost:5000/api/child-development/${childId}`,\r\n          developmentData,\r\n          {\r\n            headers: { Authorization: `Bearer ${token}` }\r\n          }\r\n        );\r\n\r\n        this.$router.push(`/child-development-list/${childId}`);\r\n      } catch (error) {\r\n        console.error('Error submitting development data:', error);\r\n        this.errorMessage = 'Greška prilikom čuvanja podataka.';\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.child-development-form {\r\n  max-width: 600px;\r\n  margin: 0 auto;\r\n  padding: 20px;\r\n  background-color: #f9f9f9;\r\n  border-radius: 8px;\r\n  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);\r\n  \r\n  .form-title {\r\n    text-align: center;\r\n    font-size: 24px;\r\n    color: #333;\r\n    margin-bottom: 20px;\r\n  }\r\n\r\n  .form-container {\r\n    display: flex;\r\n    flex-direction: column;\r\n  }\r\n\r\n  .form-group {\r\n    margin-bottom: 15px;\r\n    \r\n    label {\r\n      font-size: 16px;\r\n      font-weight: bold;\r\n      color: #333;\r\n      margin-bottom: 5px;\r\n    }\r\n\r\n    .form-input {\r\n      width: 100%;\r\n      height: 100px;\r\n      padding: 10px;\r\n      font-size: 14px;\r\n      border: 1px solid #ccc;\r\n      border-radius: 4px;\r\n      resize: none;\r\n      box-sizing: border-box;\r\n    }\r\n  }\r\n\r\n  .submit-btn {\r\n    padding: 12px;\r\n    font-size: 16px;\r\n    color: #fff;\r\n    background-color: #4CAF50;\r\n    border: none;\r\n    border-radius: 4px;\r\n    cursor: pointer;\r\n    transition: background-color 0.3s ease;\r\n    \r\n    &:hover {\r\n      background-color: #45a049;\r\n    }\r\n  }\r\n\r\n  .error-message {\r\n    margin-top: 20px;\r\n    padding: 10px;\r\n    background-color: #ffdddd;\r\n    border: 1px solid #f5c6cb;\r\n    color: #721c24;\r\n    border-radius: 4px;\r\n  }\r\n}\r\n\r\n.submit-btn:disabled {\r\n  background-color: #cccccc;\r\n  cursor: not-allowed;\r\n  \r\n  &:hover {\r\n    background-color: #cccccc;\r\n  }\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}